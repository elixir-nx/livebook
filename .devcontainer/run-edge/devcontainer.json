// For format details, see https://aka.ms/devcontainer.json.
// Also see https://github.com/microsoft/vscode-dev-containers/tree/v0.231.6/containers/elixir-phoenix-postgres
{
  "name": "Livebook edge",
  "image": "livebook/livebook:edge",
  "extensions": ["JakeBecker.elixir-ls"],
  "forwardPorts": [8080, 8081],
  "otherPortsAttributes": {
    "onAutoForward": "ignore"
  },
  // Codespaces doesn't have a good way to execute a command as soon as a container starts (any CMD in the Dockerfile is ignored),
  // so the only thing we can do is link the executable to the workspaces directory for easier use.
  "postCreateCommand": "ln -sf /app/bin/livebook /workspaces/livebook",
  "settings": {
    // Needed because of: https://github.com/microsoft/vscode/issues/102057#issuecomment-657728467
    "debug.javascript.autoAttachFilter": "onlyWithFlag",
    "debug.javascript.autoAttachSmartPattern": [
      "!**/node_modules/**",
      "**/$KNOWN_TOOLS$/**"
    ]
  },
  "remoteEnv": {
    "PATH": "${containerEnv:PATH}:/home/livebook/.mix/escripts",
    "LIVEBOOK_HOME": "/data",
    "LIVEBOOK_DATA_PATH": "/data"
  }
}
